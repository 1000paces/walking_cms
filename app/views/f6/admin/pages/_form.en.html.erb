<%= link_to "<i class='fa fa-fw fa-arrow-left'></i>".html_safe, admin_pages_path, :title => "Close", :class => "wcms-sidebar-link wcms-close-drawer-link left", :remote => true -%>
<h4 class="lead text-center wcms-white-text">
  <%- if @page.new_record? -%>
    <i class="<%= Page::ICON_EMPTY -%>"></i> New Page
  <%- else -%>
    <i class="<%= Page::ICON -%>"></i> <%= @page.label -%>
  <%- end -%>
</h4>
      
<%= form_for([:admin,  @page], html: {class: "wcms-sidebar-form", role: 'form' }, :remote => true) do |f| %>
  <fieldset class="form-group">
    <label for="page_label" class="form-control-label wcms-form-label wcms-white-text">Label
      <%= f.text_field :label, :class => "form-control form-control-xs" -%>
    </label>
    <p class="wcms-form-help help-text" id="label_help">The text that will appear in your website's navigation.</p>
  </fieldset>
  <fieldset class="form-group">
    <label for="page_label" class="form-control-label wcms-form-label wcms-white-text">Title</label>
    <%= f.text_field :title, :class => "form-control form-control-xs" -%>
    <p class="wcms-form-help help-text" id="title_help">The text that will appear in the browser tab or the top of the browser window.</p>
  </fieldset>
  <fieldset class="form-group">
    <label for="page_permalink" class="form-control-label wcms-form-label wcms-white-text">Link</label>
    <%= f.text_field :permalink, :class => "form-control form-control-xs" -%>
    <p class="wcms-form-help help-text" id="permalink_help">The friendly name of this page as it will appear in your page's web address.  Must be unique.</p>
  </fieldset>
  <%= f.fields_for :setting, @page.setting do |b| -%>
    <div class="small button-group">
      <%= b.radio_button :fluid, true -%><label class="wcms-fluid button secondary" for="page_setting_attributes_fluid_true">Fluid Layout</label>
      <%= b.radio_button :fluid, false -%><label class="wcms-fluid button secondary" for="page_setting_attributes_fluid_false">Static Layout</label>
    </div>
    <fieldset class="form-group">
      <label class="small form-control-label wcms-form-label wcms-white-text" for="setting_font_id">Font</label>
      <%= b.select(:font_id, Font.alpha_collection, {}, {:class => "form-control form-control-sm"}) %>
    </fieldset>
    <div class="small button-group">
        <%= b.radio_button :font_weight, 100 -%><label class="wcms-font wcms-thin button secondary" for="page_setting_attributes_font_weight_100">Thin Font</label>
        <%= b.radio_button :font_weight, 400 -%><label class="wcms-font wcms-normal button secondary" for="page_setting_attributes_font_weight_400">Normal Font</label>
        <%= b.radio_button :font_weight, 700 -%><label class="wcms-font wcms-heavy button secondary" for="page_setting_attributes_font_weight_700">Heavy Font</label>
    </div>    
    <fieldset class="form-group">
      <label class="small form-control-label wcms-form-label wcms-white-text" for="setting_nav_location">Navigation Location</label>
      <%= b.select(:nav_location, Setting::NAV_LOCATION, {}, {:class => "form-control form-control-sm"}) %>
    </fieldset>
    <fieldset class="form-group">
      <label for="setting_border" class="show-for-sr">Overlap Header & Navigation</label>
      <label class="wcms-white-text small checkbox-inline">
        <%= b.check_box(:overlap, {}, 1, 0) %> Overlap Header & Navigation
      </label>
    </fieldset>
    <fieldset class="form-group">
      <label for="page_label" class="small form-control-label wcms-form-label wcms-white-text" for="setting_nav_color">Navigation Color</label>
      <%= b.text_field :nav_color, :class => "form-control form-control-xs", :readonly => true -%>
      <script>
        $("#page_setting_attributes_nav_color").minicolors({opacity: true, format: 'rgb', position: 'top right'});
      </script>
    </fieldset>
  <%- end -%>
  <div class="small button-group">
    <%= f.radio_button(:status, "PUBLIC") %><label class="wcms-publish button secondary" for="page_status_public"><i class='fa fa-flag-checkered'></i> Publish Page</label>
    <%= f.radio_button(:status, "DRAFT") %><label class="wcms-draft button secondary" for="page_status_draft"><i class='fa fa-exclamation-triangle'></i> Draft</label>
    <%= f.radio_button(:status, "DELETE") %><label class="wcms-delete button secondary" for="page_status_delete"><i class='fa fa-trash'></i> Delete</label>
  </div>
  <p class="wcms-form-help help-text" id="status_help">Select "Publish" when your page is ready to view.</p>
  
  <fieldset class="form-group wcms-action-group">
    <%= f.submit 'Save Changes', class: 'button secondary' %>
    <%= link_to "Cancel", admin_pages_path, :title => "Cancel", :id => "cancel-button", :class => "button secondary small pull-right", :remote => true -%>
  </fieldset>
  <%- unless @page.new_record? -%>
    <fieldset class="form-group wcms-action-group text-center">
      <%= link_to "<i class='#{Page::CLONE}'></i> Copy Page".html_safe, admin_duplicate_page_path(@page), :class => "button secondary small wcms-duplicate", :title => "Duplicate", :id => "wcms-duplicate", :remote => true -%>
    </fieldset>
  <%- end -%>
<%- end -%>

<script type="text/javascript">
  $("#page_label").focusout(function(){
    if($("#page_title").val().length == 0 ){
      $("#page_title_spinner").toggleClass("hidden show");
      var txt = $("#page_label").val();
      $("#page_title").val(txt);
      $("#page_title_spinner").toggleClass("hidden show");
    };
  });

  $("#page_label, #page_title, #page_permalink").focusout(function(){
    if($("#page_permalink").val().length == 0 ){
      var slug = $("#page_title").val().toLowerCase();
      slug = slug.replace(/[^a-zA-Z0-9]+/g,'-');
      slug = encodeURI(slug)
      $("#page_permalink").val(slug);
    };
  });   
</script>