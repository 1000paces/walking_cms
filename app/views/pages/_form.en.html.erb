
<h4 class="lead text-xs-center wcms-white-text"> 
  <i class="<%= Page::ICON -%>"></i>
  <%- if @page.new_record? -%>
    New Page
  <%- else -%>
    <em><%= @page.label -%></em>
  <%- end -%>
</h4>
      
<%= form_for(@page, html: {class: "wcms-sidebar-form", role: 'form' }, :remote => true) do |f| %>
  <%- if @page.errors.any? -%>
    <div id="error_explanation" class="alert alert-danger">
      <strong><%= pluralize(@page.errors.count, "error") %> prohibited this page from being saved:</strong>
      <ul>
      <%- @page.errors.full_messages.each do |message| -%>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <%- end -%>
  <fieldset class="form-group">
    <label for="page_label" class="wcms-white-text">Label</label>
    <%= f.text_field :label, :class => "form-control form-control-sm" -%>
    <small class="wcms-form-help">The text that will appear in your website's navigation.</small>
  </fieldset>
  <fieldset class="form-group">
    <label for="page_label" class="wcms-white-text">Title</label>
    <%= f.text_field :title, :class => "form-control form-control-sm" -%>
    <span aria-hidden="true" id="page_title_spinner" class="form-control-feedback hidden"><i class="fa fa-cog fa-spin text-muted"></i></span>
    <small class="wcms-form-help">The text that will appear in the browser tab or the top of the browser window.</small>
  </fieldset>
  <fieldset class="form-group">
    <label for="page_permalink" class="wcms-white-text">Link</label>
    <%= f.text_field :permalink, :class => "form-control form-control-sm" -%>
    <small class="wcms-form-help">The friendly name of this page as it will appear in your page's web address.  Must be unique.</small>
  </fieldset>
  <div class="radio">
    <label class="small radio wcms-white-text"><%= f.radio_button(:fluid, true) %> Fluid Layout</label> 
    <label class="small radio wcms-white-text"><%= f.radio_button(:fluid, false) %> Static Layout</label>
    <small class="wcms-form-help">Choose "Fluid" if you want columns to grow and shrink when the browser is resized, otherwise choose 'Static.'</small>
  </div>           
  <div class="radio">
    <label class="small radio-inline wcms-white-text"><%= f.radio_button(:status, "PUBLIC") %> Published</label> 
    <label class="small radio-inline wcms-white-text"><%= f.radio_button(:status, "DRAFT") %> Draft</label>
    <small class="wcms-form-help">Select "Published" when your page is ready to view.</small>
  </div>      
  <fieldset class="form-group">  
    <%= f.submit 'Save', class: 'btn btn-secondary-outline btn-sm' %>
    <%#= link_to 'Cancel', "#", :class => "btn btn-warning-outline btn-sm pull-xs-right", :id => "cancel-button" %>
    <%= link_to "Cancel", pages_path, :title => "Cancel", :id => "cancel-button", :class => "btn btn-warning-outline btn-sm pull-xs-right", :remote => true -%>
  </fieldset>
<%- end -%>

<script type="text/javascript">
  $('#cancel-button').on('click', function(e){
    /*
    e.preventDefault();
    $("#wcms-form-box").hide("slide", { direction: "right" }, 750, function(){
      $(this).empty();
    });
    $("#wcms-drawer-pages").show("slide", { direction: "left" }, 750);
    */
  });

  $("#page_label").focusout(function(){
    if($("#page_title").val().length == 0 ){
      $("#page_title_spinner").toggleClass("hidden show");
      var txt = $("#page_label").val();
      $("#page_title").val(txt);
      $("#page_title_spinner").toggleClass("hidden show");
    };
  });

  $("#page_title").focusout(function(){
    if($("#page_permalink").val().length == 0 ){
      var slug = $("#page_title").val().toLowerCase();
      slug = slug.replace(/[^a-zA-Z0-9]+/g,'-');
      slug = encodeURI(slug)
      $("#page_permalink").val("/" + slug);
    };
  });   
</script>