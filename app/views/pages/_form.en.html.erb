
<h4 class="lead text-xs-center wcms-white-text"> 
  <i class="<%= Page::ICON -%>"></i>
  <%- if @page.new_record? -%>
    New Page
  <%- else -%>
    <em><%= @page.label -%></em>
  <%- end -%>
</h4>
      
<%= form_for(@page, html: {class: "wcms-sidebar-form", role: 'form' }, :remote => true) do |f| %>
  <%- if @page.errors.any? -%>
    <div id="error_explanation" class="alert alert-danger">
      <strong><%= pluralize(@page.errors.count, "error") %> prohibited this page from being saved:</strong>
      <ul>
      <%- @page.errors.full_messages.each do |message| -%>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <%- end -%>
  <fieldset class="form-group">
    <label for="page_label" class="wcms-white-text">Label</label>
    <%= f.text_field :label, :class => "form-control form-control-sm" -%>
    <small class="wcms-form-help">The text that will appear in your website's navigation.</small>
  </fieldset>
  <fieldset class="form-group">
    <label for="page_label" class="wcms-white-text">Title</label>
    <%= f.text_field :title, :class => "form-control form-control-sm" -%>
    <span aria-hidden="true" id="page_title_spinner" class="form-control-feedback hidden"><i class="fa fa-cog fa-spin text-muted"></i></span>
    <small class="wcms-form-help">The text that will appear in the browser tab or the top of the browser window.</small>
  </fieldset>
  <fieldset class="form-group">
    <label for="page_permalink" class="wcms-white-text">Link</label>
    <%= f.text_field :permalink, :class => "form-control form-control-sm" -%>
    <small class="wcms-form-help">The friendly name of this page as it will appear in your page's web address.  Must be unique.</small>
  </fieldset>
  <%= f.fields_for :setting, @page.setting do |b| -%>
    <fieldset class="form-group">
      <label class="small wcms-white-text" for="setting_font_id">Font</label>
      <%= b.select(:font_id, Font.alpha_collection, {:include_blank => true}, {:class => "form-control form-control-sm"}) %>
    </fieldset>
    <fieldset class="form-group">
      <label class="small wcms-white-text" for="setting_font_id">Font Weight</label>
      <div class="radio">
        <label class="wcms-white-text radio-inline">
          <small><%= b.radio_button :font_weight, 100 -%> Thin</small>
        </label>
        <label class="wcms-white-text radio-inline">
          <small><%= b.radio_button :font_weight, 400 -%> Normal</small>
        </label>
        <label class="wcms-white-text radio-inline">
          <small><%= b.radio_button :font_weight, 700 -%> Heavy</small>
        </label>
      </div>  
    <fieldset class="form-group">
      <label class="small wcms-white-text" for="setting_fluid">Layout</label>
      <div class="radio">
        <label class="wcms-white-text radio-inline">
          <small><%= b.radio_button :fluid, true -%> Fluid Layout</small>
        </label>
        <label class="wcms-white-text radio-inline">
          <small><%= b.radio_button :fluid, false -%> Static Layout</small>
        </label>
      </div>
    </fieldset>
    <fieldset class="form-group">
      <label class="small wcms-white-text" for="setting_font_id">Navigation Location</label>
      <%= b.select(:nav_location, Setting::NAV_LOCATION, {}, {:class => "form-control form-control-sm"}) %>
    </fieldset>
    <fieldset class="form-group">
      <label class="small wcms-white-text" for="setting_font_id">Navigation Color</label>
      <%= b.select(:nav_color, Setting::NAV_COLOR, {}, {:class => "form-control form-control-sm"}) %>
    </fieldset>    
  <%- end -%>
  <div class="radio">
    <label class="small radio-inline wcms-white-text"><%= f.radio_button(:status, "PUBLIC") %> Published</label> 
    <label class="small radio-inline wcms-white-text"><%= f.radio_button(:status, "DRAFT") %> Draft</label>
    <small class="wcms-form-help">Select "Published" when your page is ready to view.</small>
  </div>
  <fieldset class="form-group">  
    <%= f.submit 'Save', class: 'btn btn-secondary-outline btn-sm' %>
    <%= link_to "Cancel", pages_path, :title => "Cancel", :id => "cancel-button", :class => "btn btn-warning-outline btn-sm pull-xs-right", :remote => true -%>
  </fieldset>
<%- end -%>

<script type="text/javascript">
  $("#page_label").focusout(function(){
    if($("#page_title").val().length == 0 ){
      $("#page_title_spinner").toggleClass("hidden show");
      var txt = $("#page_label").val();
      $("#page_title").val(txt);
      $("#page_title_spinner").toggleClass("hidden show");
    };
  });

  $("#page_title").focusout(function(){
    if($("#page_permalink").val().length == 0 ){
      var slug = $("#page_title").val().toLowerCase();
      slug = slug.replace(/[^a-zA-Z0-9]+/g,'-');
      slug = encodeURI(slug)
      $("#page_permalink").val("/" + slug);
    };
  });   
</script>